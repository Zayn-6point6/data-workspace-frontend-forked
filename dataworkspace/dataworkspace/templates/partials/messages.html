{% load datasets_tags %}

{% for message in messages %}
  {% if message.tags == 'error' %}
    <div class="govuk-notification-banner" role="alert" aria-labelledby="govuk-notification-banner-title" data-module="govuk-notification-banner">
      <div class="govuk-notification-banner__header">
        <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
          There is a problem
        </h2>
      </div>
      <div class="govuk-notification-banner__content">
        <p class="govuk-notification-banner__heading">
          {{ message }}
        </p>
      </div>
    </div>
  {% endif %}
  {% if message.tags == 'success' %}
    <div class="govuk-notification-banner govuk-notification-banner--success" role="alert" aria-labelledby="govuk-notification-banner-title" data-module="govuk-notification-banner">
      <div class="govuk-notification-banner__header">
        <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">
          Success
        </h2>
      </div>
      <div class="govuk-notification-banner__content">
        <p class="govuk-notification-banner__heading">
          {{ message }}
        </p>
      </div>
    </div>
  {% endif %}
  {% if message.level == GA_EVENT_MESSAGE_TYPE %}
    <script nonce="{{ request.csp_nonce }}">
      window.dataLayer = window.dataLayer || [];
      dataLayer.push({
        "event": "GAEvent",
        "eventCategory": "{{ message.message|split_string:"|"|first }}",
        "eventAction": "{{ message.message|split_string:"|"|last }}",
        "eventLabel": "{{ message.tags }}",
      })
    </script>
  {% endif %}

{% endfor %}
